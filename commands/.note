refactor this. so much copied code... seriously monkey